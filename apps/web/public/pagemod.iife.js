var __defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,o)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,__spreadValues=(e,t)=>{for(var o in t||(t={}))__hasOwnProp.call(t,o)&&__defNormalProp(e,o,t[o]);if(__getOwnPropSymbols)for(var o of __getOwnPropSymbols(t))__propIsEnum.call(t,o)&&__defNormalProp(e,o,t[o]);return e},__async=(e,t,o)=>new Promise((n,r)=>{var a=e=>{try{i(o.next(e))}catch(t){r(t)}},c=e=>{try{i(o.throw(e))}catch(t){r(t)}},i=e=>e.done?n(e.value):Promise.resolve(e.value).then(a,c);i((o=o.apply(e,t)).next())});!function(){"use strict";function e(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function t(e,t){return __async(this,null,function*(){const o=`${t}/p?${e}`,n=`pm_cache_${btoa(o)}`;try{const e=sessionStorage.getItem(n);if(e)return JSON.parse(e);const t=new AbortController,r=setTimeout(()=>t.abort(),250),a=yield fetch(o,{method:"GET",keepalive:!0,signal:t.signal,headers:{Accept:"application/json"}});if(clearTimeout(r),!a.ok)throw new Error(`HTTP ${a.status}`);const c=yield a.json();return sessionStorage.setItem(n,JSON.stringify(c)),c}catch(r){return r instanceof Error&&"AbortError"===r.name?(console.warn("PageMod: Request timeout, retrying..."),yield function(e,t){return __async(this,null,function*(){try{const o=`${t}/p?${e}`,n=new AbortController,r=setTimeout(()=>n.abort(),500),a=yield fetch(o,{method:"GET",keepalive:!0,signal:n.signal,headers:{Accept:"application/json"}});if(clearTimeout(r),!a.ok)throw new Error(`HTTP ${a.status}`);return yield a.json()}catch(r){return console.warn("PageMod: Retry failed:",r),null}})}(e,t)):(console.warn("PageMod: Failed to fetch payload:",r),null)}})}function o(e,t){switch(t.type){case"html":e.innerHTML=t.value;break;case"text":e.textContent=t.value;break;case"attr":t.attribute&&e.setAttribute(t.attribute,t.value);break;default:console.warn(`PageMod: Unknown patch type: ${t.type}`)}}function n(e,t={},o){try{const n=__spreadValues({event:e,timestamp:Date.now(),url:window.location.href},t),r=new Blob([JSON.stringify(n)],{type:"application/json"});navigator.sendBeacon(`${o}/t`,r)}catch(n){console.warn("PageMod: Failed to send telemetry:",n)}}function r(e){if(e.id)return`#${e.id}`;if(e.className){const t=e.className.split(" ").filter(Boolean);if(t.length>0)return`.${t[0]}`}return e.tagName.toLowerCase()}const a="http://i.localhost:3000";function c(){return __async(this,null,function*(){try{if(document.cookie.includes("pagemod=off"))return;const i=function(e){return{url:window.location.href,referrer:document.referrer||"",device:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?"mobile":"desktop",lang:navigator.language||"en",uid:e}}(function(){const t="pm_uid";try{let o=localStorage.getItem(t);return o||(o=e(),localStorage.setItem(t,o)),window.__pm_uid=o,o}catch(o){return console.warn("PageMod: localStorage not available, using session ID"),e()}}()),s=Object.fromEntries(Object.entries(i).map(([e,t])=>[e,String(t)])),l=(c=s,Object.entries(c).filter(([,e])=>void 0!==e&&""!==e).map(([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`).join("&")),u=yield t(l,a);if(!u||!u.patches)return;!function(e){if(!e||0===e.length)return;const t=new Map;for(const o of e)t.has(o.selector)||t.set(o.selector,[]),t.get(o.selector).push(o);requestAnimationFrame(()=>{for(const[r,a]of t)try{const t=document.querySelectorAll(r);for(const n of t)for(const t of a)try{o(n,t)}catch(e){console.warn(`PageMod: Failed to apply patch ${t.type} on ${r}:`,e)}}catch(n){console.warn(`PageMod: Invalid selector "${r}":`,n)}window.dispatchEvent(new Event("pagemod:done"))})}(u.patches),n("impression",{},a),function(e){document.addEventListener("click",t=>{const o=t.target.closest("[data-mu-track]");if(o){const t=o.getAttribute("data-mu-track"),a=t?JSON.parse(t):{};n("click",__spreadValues({element:o.tagName.toLowerCase(),selector:r(o)},a),e)}})}(a)}catch(i){console.warn("PageMod: Failed to load:",i)}var c})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",c):c(),window.PageMod={load:c}}();
